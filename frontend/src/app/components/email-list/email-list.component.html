<!-- Email List Page -->
<div class="email-list-wrapper">
  <div class="email-list-container">
    <!-- Header Section -->
    <div class="page-header">
      <div class="header-content">
        <div class="title-section">
          <div class="title-icon">
            <i class="pi pi-envelope"></i>
          </div>
          <div class="title-text">
            <h1 class="page-title">Sent Emails</h1>
            <p class="page-subtitle">View your email history</p>
          </div>
        </div>
        <div class="header-actions">
          <button class="action-btn secondary" (click)="loadSentEmails()">
            <i class="pi pi-refresh"></i>
            Refresh
          </button>
          <button class="action-btn primary" routerLink="/send-email">
            <i class="pi pi-send"></i>
            Send Email
          </button>
          <button class="action-btn primary" routerLink="/dashboard">
            <i class="pi pi-home"></i>
            Dashboard
          </button>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="content-section">
      <!-- Loading State -->
      <div *ngIf="isLoading" class="loading-state">
        <div class="loading-spinner">
          <i class="pi pi-spin pi-spinner"></i>
        </div>
        <p class="loading-text">Loading your sent emails...</p>
      </div>

      <!-- Error State -->
      <div *ngIf="error && !isLoading" class="error-state">
        <div class="error-icon">
          <i class="pi pi-exclamation-triangle"></i>
        </div>
        <h3>Error Loading Emails</h3>
        <p>{{ error }}</p>
        <button class="action-btn primary" (click)="loadSentEmails()">
          <i class="pi pi-refresh"></i>
          Try Again
        </button>
      </div>

      <!-- Emails Table -->
      <div *ngIf="!isLoading && !error && sentEmails.length > 0" class="emails-table-container">
        <div class="table-header">
          <h2 class="table-title">Email History</h2>
          <div class="table-info">
            <span class="email-count">{{ sentEmails.length }} emails</span>
          </div>
        </div>

        <div class="emails-table">
          <div class="table-head">
            <div class="table-row header-row">
              <div class="table-cell">ID</div>
              <div class="table-cell">Recipient</div>
              <div class="table-cell">Subject</div>
              <div class="table-cell">Date & Time</div>
              <div class="table-cell">Status</div>
              <div class="table-cell">Actions</div>
            </div>
          </div>
          
          <div class="table-body">
            <div *ngFor="let email of sentEmails" class="table-row data-row">
              <div class="table-cell">
                <span class="email-id">#{{ email.id }}</span>
              </div>
              <div class="table-cell">
                <div class="recipient-info">
                  <i class="pi pi-user"></i>
                  <span class="recipient-email">{{ email.recipient }}</span>
                </div>
              </div>
              <div class="table-cell">
                <div class="subject-info">
                  <span class="subject-text">{{ email.subject }}</span>
                </div>
              </div>
              <div class="table-cell">
                <div class="date-time">
                  <span class="date">{{ email.sentAt | date:'mediumDate' }}</span>
                  <span class="time">{{ email.sentAt | date:'shortTime' }}</span>
                </div>
              </div>
              <div class="table-cell">
                <div class="status-badge" [class]="getStatusClass(email.status)">
                  <i class="pi" [class]="getStatusIcon(email.status)"></i>
                  <span>{{ getStatusLabel(email.status) }}</span>
                </div>
              </div>
              <div class="table-cell">
                <button class="view-btn" (click)="viewEmailDetails(email)">
                  <i class="pi pi-eye"></i>
                  <span>View</span>
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Pagination -->
        <div class="pagination-container" *ngIf="sentEmails.length > 10">
          <div class="pagination-info">
            <span>Showing 1-{{ Math.min(10, sentEmails.length) }} of {{ sentEmails.length }} emails</span>
          </div>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="!isLoading && !error && sentEmails.length === 0" class="empty-state">
        <div class="empty-icon">
          <i class="pi pi-envelope"></i>
        </div>
        <div class="empty-content">
          <h3>No Emails Sent Yet</h3>
          <p>You haven't sent any emails yet. Start by sending your first email!</p>
          <button class="action-btn primary" routerLink="/send-email">
            <i class="pi pi-send"></i>
            Send Email
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Email Details Dialog -->
<div class="dialog-overlay" *ngIf="showEmailDialog" (click)="closeEmailDialog()">
  <div class="dialog-container" (click)="$event.stopPropagation()">
    <div class="dialog-header">
      <div class="dialog-title">
        <i class="pi pi-envelope"></i>
        <span>Email Details</span>
      </div>
      <button class="dialog-close" (click)="closeEmailDialog()">
        <i class="pi pi-times"></i>
      </button>
    </div>
    
    <div class="dialog-content" *ngIf="selectedEmail">
      <div class="detail-grid">
        <div class="detail-item">
          <label class="detail-label">Email ID</label>
          <span class="email-id">#{{ selectedEmail.id }}</span>
        </div>
        <div class="detail-item">
          <label class="detail-label">Status</label>
          <div class="status-badge" [class]="getStatusClass(selectedEmail.status)">
            <i class="pi" [class]="getStatusIcon(selectedEmail.status)"></i>
            <span>{{ getStatusLabel(selectedEmail.status) }}</span>
          </div>
        </div>
      </div>
      
      <div class="detail-item">
        <label class="detail-label">Recipient</label>
        <div class="recipient-info">
          <i class="pi pi-user"></i>
          <span>{{ selectedEmail.recipient }}</span>
        </div>
      </div>
      
      <div class="detail-item">
        <label class="detail-label">Subject</label>
        <p class="detail-text">{{ selectedEmail.subject }}</p>
      </div>
      
      <div class="detail-item" *ngIf="selectedEmail.body">
        <label class="detail-label">Message</label>
        <div class="message-content">
          <p class="detail-text">{{ selectedEmail.body }}</p>
        </div>
      </div>
      
      <div class="detail-grid">
        <div class="detail-item">
          <label class="detail-label">Sent At</label>
          <p class="detail-text">{{ selectedEmail.sentAt | date:'medium' }}</p>
        </div>
        <div class="detail-item" *ngIf="selectedEmail.attempts">
          <label class="detail-label">Attempts</label>
          <p class="detail-text">{{ selectedEmail.attempts }}</p>
        </div>
      </div>
      
      <div class="detail-item" *ngIf="selectedEmail.failureReason">
        <label class="detail-label">Failure Reason</label>
        <div class="failure-reason">
          <p class="detail-text error">{{ selectedEmail.failureReason }}</p>
        </div>
      </div>
    </div>
    
    <div class="dialog-footer">
      <button class="action-btn secondary" (click)="closeEmailDialog()">
        <i class="pi pi-times"></i>
        Close
      </button>
    </div>
  </div>
</div>
